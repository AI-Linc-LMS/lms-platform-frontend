<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <!-- Browser tab favicon (shown in desktop browser tabs) -->
    <link rel="icon" type="image/svg+xml" href="/pwa-512x512.svg" />
    <!-- iOS viewport settings for better PWA experience -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />

    <!-- PWA Meta Tags: used by Android/Chrome for splash background and status bar -->
    <meta name="theme-color" content="#ffffff" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-config" content="/browserconfig.xml" />

    <!-- iOS specific optimizations -->
    <meta name="format-detection" content="telephone=no" />
    <meta name="mobile-web-app-capable" content="yes" />

    <!-- iOS Home Screen icon: PNG for better compatibility with white theme -->
    <link rel="apple-touch-icon" href="/pwa-192x192.png" />

    <!-- iOS multiple icon sizes for better device compatibility -->
    <link rel="apple-touch-icon" sizes="152x152" href="/pwa-192x192.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/pwa-192x192.png" />
    <link rel="apple-touch-icon" sizes="167x167" href="/pwa-192x192.png" />

    <!-- iOS splash screens (PNG). Covers common models in portrait/landscape. -->
    <!-- iPhone 14 Pro / 15 Plus (430x932 @3x) -->
    <link
      rel="apple-touch-startup-image"
      href="/splash-1290x2796.png"
      media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/splash-2796x1290.png"
      media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <!-- iPhone 15 Pro (393x852 @3x) -->
    <link
      rel="apple-touch-startup-image"
      href="/splash-1179x2556.png"
      media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/splash-2556x1179.png"
      media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <!-- iPhone 14/15 Pro Max (428x926 @3x) -->
    <link
      rel="apple-touch-startup-image"
      href="/splash-1284x2778.png"
      media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/splash-2778x1284.png"
      media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <!-- iPhone 12/13/14/15 (390x844 @3x) -->
    <link
      rel="apple-touch-startup-image"
      href="/splash-1170x2532.png"
      media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/splash-2532x1170.png"
      media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <!-- iPhone X/XS/11 Pro (375x812 @3x) -->
    <link
      rel="apple-touch-startup-image"
      href="/splash-1125x2436.png"
      media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/splash-2436x1125.png"
      media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <!-- iPhone 11/XR (414x896 @2x) -->
    <link
      rel="apple-touch-startup-image"
      href="/splash-828x1792.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/splash-1792x828.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <!-- iPhone 11 Pro Max/XS Max (414x896 @3x) -->
    <link
      rel="apple-touch-startup-image"
      href="/splash-1242x2688.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/splash-2688x1242.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    />
    <!-- iPhone 8/7/6s/6 (375x667 @2x) -->
    <link
      rel="apple-touch-startup-image"
      href="/splash-750x1334.png"
      media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/splash-1334x750.png"
      media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />
    <!-- iPhone SE 1st gen (320x568 @2x) -->
    <link
      rel="apple-touch-startup-image"
      href="/splash-640x1136.png"
      media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/splash-1136x640.png"
      media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    />

    <!-- Additional favicon sizes (optional, for desktop browsers; not used by PWA install). -->
    <link
      rel="icon"
      type="image/svg+xml"
      sizes="192x192"
      href="/pwa-192x192.svg"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      sizes="512x512"
      href="/pwa-512x512.svg"
    />

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="theme-color" content="transparent" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <!-- Safari pinned tab icon (macOS): use SVG for vector graphics -->
    <link rel="mask-icon" href="/pwa-512x512.svg" color="#ffffff" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&amp;family=Oswald:wght@400;600&amp;family=Playfair+Display:wght@400&amp;display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&amp;family=Oswald:wght@400;600&amp;family=Playfair+Display:wght@400&amp;display=swap"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&amp;family=Oswald:wght@400;600&amp;family=Playfair+Display:wght@400&amp;display=swap"
      />
    </noscript>
    <title data-branding="title"></title>
    <link rel="icon" data-branding="favicon" href="/pwa-512x512.png" />
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:type" content="website" />
    <meta property="og:title" id="og-title" content="" />
    <meta property="og:description" id="og-description" content="AI-powered learning and assessment platform" />
    <meta property="og:image" id="og-image" content="/pwa-512x512.png" />
    <meta property="og:url" id="og-url" content="" />
    <script>
      // Set og:url immediately before page loads
      (function() {
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', function() {
            const ogUrl = document.getElementById('og-url');
            if (ogUrl) ogUrl.setAttribute('content', window.location.href);
          });
        } else {
          const ogUrl = document.getElementById('og-url');
          if (ogUrl) ogUrl.setAttribute('content', window.location.href);
        }
      })();
    </script>
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" id="twitter-title" content="" />
    <meta name="twitter:description" id="twitter-description" content="AI-powered learning and assessment platform" />
    <meta name="twitter:image" id="twitter-image" content="/pwa-512x512.png" />
    
    <!-- Client ID and API URL (set via script data attribute for build-time injection) -->
    <script id="app-config" data-client-id="" data-api-url="https://be-app.ailinc.com"></script>
    
    <!-- Script to update meta tags before social scrapers read them -->
    <script>
      (function() {
        // Set default og:url immediately
        (function() {
          const ogUrl = document.getElementById('og-url');
          if (ogUrl && !ogUrl.getAttribute('content')) {
            ogUrl.setAttribute('content', window.location.href);
          }
        })();
        
        // Get client ID from script data attribute
        function getClientId() {
          const configScript = document.getElementById('app-config');
          if (configScript && configScript.dataset.clientId) {
            return configScript.dataset.clientId;
          }
          // Try localStorage (set by previous visit)
          try {
            const stored = localStorage.getItem('__client_id__');
            if (stored) return stored;
          } catch(e) {}
          return null;
        }
        
        function getApiUrl() {
          const configScript = document.getElementById('app-config');
          if (configScript && configScript.dataset.apiUrl) {
            return configScript.dataset.apiUrl.replace(/\/$/, '');
          }
          return 'https://be-app.ailinc.com';
        }
        
        const clientId = getClientId();
        const apiBaseUrl = getApiUrl();
        
        if (!clientId) {
          // No client ID available, skip fetching
          return;
        }
        
        // Store client ID for future use
        try {
          localStorage.setItem('__client_id__', clientId);
        } catch(e) {}
        
        // Function to update meta tags
        function updateMetaTags(data) {
          if (!data || !data.is_active || !data.name) return;
          
          const origin = window.location.origin;
          const appName = data.name;
          const appIcon = data.app_icon_url || origin + '/pwa-512x512.png';
          const currentUrl = window.location.href;
          
          // Update title
          const titleEl = document.querySelector('title[data-branding="title"]');
          if (titleEl) titleEl.textContent = appName;
          
          // Update Open Graph tags
          const ogTitle = document.getElementById('og-title');
          if (ogTitle) ogTitle.setAttribute('content', appName);
          
          const ogImage = document.getElementById('og-image');
          if (ogImage) ogImage.setAttribute('content', appIcon);
          
          const ogUrl = document.getElementById('og-url');
          if (ogUrl) ogUrl.setAttribute('content', currentUrl);
          
          // Update Twitter tags
          const twitterTitle = document.getElementById('twitter-title');
          if (twitterTitle) twitterTitle.setAttribute('content', appName);
          
          const twitterImage = document.getElementById('twitter-image');
          if (twitterImage) twitterImage.setAttribute('content', appIcon);
          
          // Update favicon
          const faviconEl = document.querySelector('link[data-branding="favicon"]');
          if (faviconEl && data.app_icon_url) {
            faviconEl.href = data.app_icon_url;
          }
          
          // Update apple-mobile-web-app-title
          const appleTitle = document.querySelector('meta[name="apple-mobile-web-app-title"]');
          if (appleTitle) appleTitle.setAttribute('content', appName);
        }
        
        // Fetch client info immediately (non-blocking)
        fetch(apiBaseUrl + '/api/clients/' + clientId + '/client-info/')
          .then(function(response) {
            if (!response.ok) throw new Error('Failed to fetch');
            return response.json();
          })
          .then(function(data) {
            updateMetaTags(data);
          })
          .catch(function() {
            // Silently fail - use defaults
          });
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
